<div class="layout-topbar">
	<button
		#menubutton
		class="p-link layout-menu-button layout-topbar-button"
		(click)="layoutService.onMenuToggle()"
	>
		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="24"
			height="24"
			viewBox="0 0 24 24"
			fill="none"
		>
			<path
				d="M4 18H10"
				stroke="#000000"
				stroke-width="2"
				stroke-linecap="round"
			/>
			<path
				d="M4 12L16 12"
				stroke="#000000"
				stroke-width="2"
				stroke-linecap="round"
			/>
			<path
				d="M4 6L20 6"
				stroke="#000000"
				stroke-width="2"
				stroke-linecap="round"
			/>
		</svg>
	</button>

	<!-- Spacer to push menu to the right -->
	<div class="flex-1"></div>

	<!-- User Info Display -->
	<div class="flex items-center gap-3 mr-4">
		<div class="text-right">
			<p class="text-sm font-medium text-gray-800 m-0 leading-tight">
				{{ userProfile?.firstName }} {{ userProfile?.lastName }}
			</p>
			<p class="text-xs text-gray-500 m-0 leading-tight">
				{{ userProfile?.role }}
			</p>
		</div>
		<p-avatar
			size="normal"
			shape="circle"
			class="ring-2 ring-gray-200 cursor-pointer hover:shadow-xl transition-all"
			[image]="userProfile?.profileImage"
			[label]="
				!userProfile?.profileImage
					? userProfile?.firstName?.charAt(0)
					: undefined
			"
			(click)="profileSideBarVisible = true"
		></p-avatar>
	</div>

	<div
		#topbarmenu
		class="layout-topbar-menu"
		[ngClass]="{
			'layout-topbar-menu-mobile-active':
				layoutService.state.profileSidebarVisible
		}"
	>
		<button class="p-link layout-topbar-button" (click)="logout()">
			<i class="pi pi-sign-out"></i>
		</button>
	</div>
</div>
<p-toast />
<p-confirmPopup />

<p-sidebar
	[(visible)]="profileSideBarVisible"
	position="right"
	[style]="{ width: '350px' }"
	header="Profile"
>
	<div class="flex flex-col gap-6 p-4">
		<!-- Profile Header -->
		<div class="flex flex-col items-center text-center gap-4">
			<p-avatar
				size="xlarge"
				shape="circle"
				class="ring-4 ring-blue-100"
				[image]="userProfile?.profileImage"
				[label]="
					!userProfile?.profileImage
						? userProfile?.firstName?.charAt(0)
						: undefined
				"
			></p-avatar>
			<div>
				<h3 class="text-xl font-semibold text-gray-800 m-0">
					{{ userProfile?.firstName }} {{ userProfile?.lastName }}
				</h3>
				<p class="text-sm text-blue-600 font-medium m-0">
					{{ userProfile?.role }}
				</p>
			</div>
		</div>

		<!-- Profile Details -->
		<div class="border-t pt-4">
			<div class="space-y-4">
				<div class="flex items-center gap-3">
					<i class="pi pi-envelope text-gray-400"></i>
					<div class="flex-1">
						<p class="text-xs text-gray-500 m-0">Email</p>
						<p class="text-sm font-medium text-gray-800 m-0">
							{{ userProfile?.email }}
						</p>
					</div>
				</div>

				<div class="flex items-center gap-3">
					<i class="pi pi-phone text-gray-400"></i>
					<div class="flex-1">
						<p class="text-xs text-gray-500 m-0">Phone</p>
						<p class="text-sm font-medium text-gray-800 m-0">
							{{ userProfile?.phoneNumber }}
						</p>
					</div>
				</div>

				<div class="flex items-center gap-3">
					<i class="pi pi-calendar text-gray-400"></i>
					<div class="flex-1">
						<p class="text-xs text-gray-500 m-0">Joined</p>
						<p class="text-sm font-medium text-gray-800 m-0">
							{{ userProfile?.createdAt | date : "MMM dd, yyyy" }}
						</p>
					</div>
				</div>
			</div>
		</div>

		<!-- Action Buttons -->
		<div class="flex flex-col gap-2 border-t pt-4 space-y-3">
			<p-button
				label="Edit Profile"
				icon="pi pi-user-edit"
				severity="secondary"
				outlined="true"
				fluid="true"
			></p-button>

			<p-button
				label="Change Password"
				icon="pi pi-key"
				severity="secondary"
				outlined="true"
				fluid="true"
				(onClick)="resetPassword()"
			></p-button>
		</div>
	</div>
</p-sidebar>
