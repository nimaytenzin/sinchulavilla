<!-- Admin Master Transactions Component -->
<div class="min-h-screen bg-slate-50/50 p-4 sm:p-6">
	<!-- Header Section -->
	<div class="mb-6 sm:mb-8">
		<div
			class="bg-white rounded-2xl border border-slate-200/60 overflow-hidden"
		>
			<!-- Gradient Header Bar -->
			<div class="h-1 bg-blue-500"></div>

			<div class="p-6 sm:p-8">
				<div
					class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6"
				>
					<!-- Title Section -->
					<div class="flex-1 space-y-2">
						<div class="flex items-center gap-3 mb-2">
							<div
								class="w-10 h-10 bg-blue-500 rounded-xl flex items-center justify-center"
							>
								<i class="pi pi-credit-card text-white text-lg"></i>
							</div>
							<h1 class="text-3xl sm:text-4xl font-bold text-slate-800">
								Payment Transactions
							</h1>
						</div>
						<p
							class="text-slate-600 text-base sm:text-lg leading-relaxed max-w-2xl"
						>
							Monitor and analyze payment transactions across all bookings
						</p>

						<p>
							{{ selectedDate | date : "mediumDate" }}
						</p>
					</div>

					<!-- Action Buttons -->
					<div class="flex gap-3">
						<p-button
							icon="pi pi-refresh"
							label="Refresh"
							severity="secondary"
							[outlined]="true"
							styleClass="!font-semibold !px-4 !py-2 !rounded-xl"
						></p-button>
						<p-button
							icon="pi pi-download"
							label="Export"
							[outlined]="true"
							[disabled]="(transactionsPagination?.data)!.length === 0"
							styleClass="!font-semibold !px-4 !py-2 !rounded-xl"
						></p-button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Date Filter Section -->
	<div class="mb-6 sm:mb-8">
		<div class="bg-white rounded-2xl border border-slate-200/60 p-6">
			<div class="flex gap-4 items-centerr">
				<div>
					<label
						class="flex items-center gap-2 text-sm font-semibold text-slate-700"
					>
						<i class="pi pi-calendar text-green-500"></i>
						Select Date
					</label>
					<p-calendar
						[(ngModel)]="selectedDate"
						dateFormat="dd/mm/yy"
						[showIcon]="true"
						[iconDisplay]="'input'"
						placeholder="Select date"
						styleClass="!w-64"
					></p-calendar>
				</div>
				<div class="flex items-end">
					<p-button
						label="Load Transactions"
						icon="pi pi-search"
						(onClick)="loadDataByDate(selectedDate)"
						[disabled]="isLoadingData"
						styleClass="!bg-blue-500 !border-none"
					></p-button>
				</div>
			</div>
		</div>
	</div>

	<!-- Transaction Statistics Section -->
	<div class="mb-6 sm:mb-8">
		<div class="bg-white rounded-2xl border border-slate-200/60 p-6">
			<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
				<!-- Total Transactions -->
				<div class="flex flex-col items-center justify-center">
					<div class="text-2xl font-bold text-blue-600">
						{{ transactionStatistics.totalTransactions }}
					</div>
					<div class="text-slate-600 text-sm">Total Transactions</div>
				</div>
				<!-- Total Amount -->
				<div class="flex flex-col items-center justify-center">
					<div class="text-2xl font-bold text-green-600">
						{{
							transactionStatistics.totalAmount
								| currency : "Nu." : "symbol" : "1.2-2"
						}}
					</div>
					<div class="text-slate-600 text-sm">Total Amount</div>
				</div>
				<!-- Online Transactions -->
				<div class="flex flex-col items-center justify-center">
					<div class="text-2xl font-bold text-indigo-600">
						{{ transactionStatistics.totalOnline }}
					</div>
					<div class="text-slate-600 text-sm">Online Transactions</div>
					<div class="text-green-700 text-xs mt-1">
						{{
							transactionStatistics.totalOnlineAmount
								| currency : "Nu." : "symbol" : "1.2-2"
						}}
					</div>
					<p class="text-sm text-green-700">
						Payout: Nu.{{ transactionStatistics.totalOnline * 25 }}
					</p>
				</div>
				<!-- Counter Transactions -->
				<div class="flex flex-col items-center justify-center">
					<div class="text-2xl font-bold text-orange-600">
						{{ transactionStatistics.totalCounter }}
					</div>
					<div class="text-slate-600 text-sm">Counter Transactions</div>
					<div class="text-green-700 text-xs mt-1">
						{{
							transactionStatistics.totalCounterAmount
								| currency : "Nu." : "symbol" : "1.2-2"
						}}
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Transactions Table -->
	<div class="bg-white rounded-2xl border border-slate-200/60 overflow-hidden">
		<!-- Gradient Header Bar -->
		<div class="h-1 bg-blue-500"></div>

		<div class="p-6">
			<div class="flex items-center justify-between mb-6">
				<h2 class="text-xl font-bold text-slate-800">
					Transactions for {{ selectedDate | date : "mediumDate" }}
				</h2>
			</div>

			<!-- Loading State -->
			<div *ngIf="isLoadingData" class="flex justify-center items-center py-16">
				<div class="text-center">
					<p-progressSpinner
						styleClass="w-12 h-12"
						strokeWidth="3"
					></p-progressSpinner>
					<p class="text-slate-600 mt-4">Loading transactions...</p>
				</div>
			</div>

			<!-- Transactions Table -->
			<div *ngIf="!isLoadingData">
				<p-table
					[value]="transactionsPagination?.data!"
					[paginator]="true"
					[rows]="pageSize"
					[lazy]="true"
					[showCurrentPageReport]="true"
					currentPageReportTemplate="Showing {first} to {last} of {totalRecords} transactions"
					[rowsPerPageOptions]="[10, 25, 50, 100]"
					styleClass="p-datatable-sm"
					responsiveLayout="scroll"
				>
					<ng-template pTemplate="header">
						<tr>
							<th
								class="!bg-slate-50 !text-slate-700 !font-semibold !py-4 !px-4"
							>
								Transaction ID
							</th>
							<th
								class="!bg-slate-50 !text-slate-700 !font-semibold !py-4 !px-4"
							>
								Booking ID
							</th>
							<th
								class="!bg-slate-50 !text-slate-700 !font-semibold !py-4 !px-4"
							>
								Customer
							</th>
							<th
								class="!bg-slate-50 !text-slate-700 !font-semibold !py-4 !px-4"
							>
								Amount
							</th>
							<th
								class="!bg-slate-50 !text-slate-700 !font-semibold !py-4 !px-4"
							>
								Payment Mode
							</th>
							<th
								class="!bg-slate-50 !text-slate-700 !font-semibold !py-4 !px-4"
							>
								Status
							</th>
							<th
								class="!bg-slate-50 !text-slate-700 !font-semibold !py-4 !px-4"
							>
								Gateway ID
							</th>
							<th
								class="!bg-slate-50 !text-slate-700 !font-semibold !py-4 !px-4"
							>
								Created At
							</th>
						</tr>
					</ng-template>

					<ng-template pTemplate="body" let-transaction>
						<tr class="hover:!bg-slate-50 !border-b !border-slate-100">
							<td class="!py-4 !px-4">
								<span class="font-mono text-sm text-slate-600">
									#{{ transaction.id }}
								</span>
							</td>
							<td class="!py-4 !px-4">
								<span class="font-medium text-slate-800">
									{{ transaction.bookingId }}
								</span>
							</td>
							<td class="!py-4 !px-4">
								<div
									*ngIf="transaction.customerName || transaction.customerPhone"
								>
									<div class="font-medium text-slate-800">
										{{ transaction.customerName || "N/A" }}
									</div>
									<div class="text-sm text-slate-500">
										{{ transaction.customerPhone || "N/A" }}
									</div>
								</div>
								<span
									*ngIf="
										!transaction.customerName && !transaction.customerPhone
									"
									class="text-slate-400"
								>
									N/A
								</span>
							</td>
							<td class="!py-4 !px-4">
								<span class="font-semibold text-green-600">
									{{
										transaction.amount | currency : "Nu." : "symbol" : "1.2-2"
									}}
								</span>
							</td>
							<td class="!py-4 !px-4">
								<p-tag
									[value]="transaction.paymentMode"
									severity="info"
									styleClass="!text-xs !px-2 !py-1"
								></p-tag>
							</td>
							<td class="!py-4 !px-4"></td>
							<td class="!py-4 !px-4">
								<span class="font-mono text-xs text-slate-600">
									{{ transaction.gatewayTransactionId || "N/A" }}
								</span>
							</td>
							<td class="!py-4 !px-4"></td>
						</tr>
					</ng-template>

					<ng-template pTemplate="emptymessage">
						<tr>
							<td colspan="8" class="!text-center !py-16">
								<div class="flex flex-col items-center">
									<i class="pi pi-credit-card text-4xl text-slate-400 mb-4"></i>
									<h3 class="text-lg font-semibold text-slate-600 mb-2">
										No Transactions Found
									</h3>
									<p class="text-slate-500">
										No payment transactions found for
									</p>
								</div>
							</td>
						</tr>
					</ng-template>
				</p-table>
			</div>
		</div>
	</div>
</div>

<!-- Toast Messages -->
<p-toast position="top-right"></p-toast>

<!-- Confirmation Dialog -->
<p-confirmDialog></p-confirmDialog>
