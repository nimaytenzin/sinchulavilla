<!-- Genre Management Component -->
<div class="space-y-6 max-w-7xl mx-auto">
	<!-- Header -->
	<div class="flex justify-between items-center">
		<div>
			<h1 class="text-3xl font-bold text-gray-900 dark:text-white">
				Genre Management
			</h1>
			<p class="text-gray-600 dark:text-gray-400 mt-1">
				Genre Master Table - used to categorize movies by their genres
			</p>
		</div>
		<div class="flex items-center gap-3">
			<p-button
				icon="pi pi-refresh"
				severity="secondary"
				[outlined]="true"
				(onClick)="refreshData()"
				pTooltip="Refresh Data"
			></p-button>
			<p-button
				icon="pi pi-download"
				severity="secondary"
				[outlined]="true"
				(onClick)="exportGenres()"
				pTooltip="Export Genres"
			></p-button>
		</div>
	</div>

	<!-- Success/Error Messages -->
	<div
		*ngIf="successMessage"
		class="p-4 mb-4 text-sm text-green-800 rounded-lg bg-green-50 dark:bg-gray-800 dark:text-green-400"
	>
		<div class="flex items-center">
			<i class="pi pi-check-circle mr-2"></i>
			{{ successMessage }}
		</div>
	</div>

	<div
		*ngIf="errorMessage"
		class="p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-gray-800 dark:text-red-400"
	>
		<div class="flex items-center">
			<i class="pi pi-exclamation-triangle mr-2"></i>
			{{ errorMessage }}
		</div>
	</div>

	<!-- Search and Filter Bar -->
	<div
		class="flex justify-between items-center gap-4 flex-wrap"
		*ngIf="showFilters"
	>
		<div class="flex-1 max-w-md">
			<p-inputGroup>
				<p-inputGroupAddon>
					<i class="pi pi-search"></i>
				</p-inputGroupAddon>
				<input
					type="text"
					pInputText
					placeholder="Search genres..."
					[(ngModel)]="searchQuery"
					(input)="onSearchChange()"
					class="w-full"
				/>
				<p-inputGroupAddon *ngIf="searchQuery">
					<i class="pi pi-times cursor-pointer" (click)="clearSearch()"></i>
				</p-inputGroupAddon>
			</p-inputGroup>
		</div>

		<div class="flex items-center gap-4">
			<!-- Sort By -->
			<p-dropdown
				[options]="sortOptions"
				[(ngModel)]="filters.sortBy"
				(onChange)="applyFilters()"
				optionLabel="label"
				optionValue="value"
				styleClass="min-w-[130px]"
			></p-dropdown>

			<!-- Sort Order -->
			<p-dropdown
				[options]="sortOrderOptions"
				[(ngModel)]="filters.sortOrder"
				(onChange)="applyFilters()"
				optionLabel="label"
				optionValue="value"
				styleClass="min-w-[130px]"
			></p-dropdown>

			<!-- Add Button -->
			<p-button
				*ngIf="showAddButton"
				label="Add Genre"
				icon="pi pi-plus"
				(onClick)="addGenre()"
				severity="primary"
			></p-button>
		</div>
	</div>

	<!-- Loading State -->
	<div class="flex justify-center items-center py-16" *ngIf="loading">
		<div class="text-center">
			<p-progressBar mode="indeterminate" styleClass="mb-4"></p-progressBar>
			<p class="text-slate-600">Loading genres...</p>
		</div>
	</div>

	<!-- Content Area -->
	<div *ngIf="!loading && filteredGenres.length > 0">
		<!-- Table View -->
		<p-table
			[value]="filteredGenres"
			dataKey="id"
			[rowHover]="true"
			styleClass="p-datatable-sm"
			[sortField]="filters.sortBy"
			[sortOrder]="filters.sortOrder === 'asc' ? 1 : -1"
		>
			<ng-template pTemplate="header">
				<tr>
					<th pSortableColumn="name">
						Genre Name
						<p-sortIcon field="name"></p-sortIcon>
					</th>
					<th pSortableColumn="createdAt">
						Created Date
						<p-sortIcon field="createdAt"></p-sortIcon>
					</th>
					<th>Actions</th>
				</tr>
			</ng-template>

			<ng-template pTemplate="body" let-genre>
				<tr>
					<td>
						<div class="flex items-center gap-3">
							<div
								class="w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full flex items-center justify-center"
							>
								<i class="pi pi-bookmark text-white text-xs"></i>
							</div>
							<span class="font-medium">{{ genre.name }}</span>
						</div>
					</td>
					<td>{{ genre.createdAt | date : "MMM dd, yyyy" }}</td>
					<td class="text-center">
						<div class="flex justify-center gap-1">
							<p-button
								icon="pi pi-pencil"
								severity="secondary"
								size="small"
								[text]="true"
								(onClick)="editGenre(genre)"
								pTooltip="Edit Genre"
							></p-button>
							<p-button
								icon="pi pi-trash"
								severity="danger"
								size="small"
								[text]="true"
								(onClick)="deleteGenre(genre)"
								pTooltip="Delete Genre"
							></p-button>
						</div>
					</td>
				</tr>
			</ng-template>
		</p-table>
	</div>

	<!-- Empty State -->
	<div
		*ngIf="!loading && filteredGenres.length === 0"
		class="text-center py-16 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700"
	>
		<div class="flex flex-col items-center gap-4">
			<i class="pi pi-bookmark text-6xl text-gray-400"></i>
			<div class="text-gray-500 dark:text-gray-400">
				<h3 class="text-xl font-medium mb-2">No genres found</h3>
				<p class="text-sm max-w-md mx-auto">
					{{
						searchQuery
							? "No genres match your search criteria. Try different keywords or clear the search."
							: "Get started by adding your first genre to the system."
					}}
				</p>
			</div>
			<div class="flex gap-3">
				<p-button
					*ngIf="searchQuery"
					label="Clear Search"
					icon="pi pi-filter-slash"
					severity="secondary"
					outlined="true"
					(onClick)="clearSearch()"
				>
				</p-button>
				<p-button label="Add Genre" icon="pi pi-plus" (onClick)="addGenre()">
				</p-button>
			</div>
		</div>
	</div>
</div>

<!-- Add/Edit Genre Dialog -->
<p-dialog
	[(visible)]="showAddEditDialog"
	[header]="editingGenre ? 'Edit Genre' : 'Add New Genre'"
	[modal]="true"
	[style]="{ width: '40vw', maxWidth: '500px' }"
	[draggable]="false"
	[resizable]="false"
>
	<form class="space-y-6">
		<div>
			<label for="genreName" class="block text-sm font-medium mb-2"
				>Genre Name *</label
			>
			<input
				pInputText
				id="genreName"
				[(ngModel)]="genreForm.name"
				name="genreName"
				placeholder="Enter genre name"
				class="w-full"
				[class.border-red-500]="!genreForm.name && showValidationErrors"
				required
			/>
			<small
				*ngIf="!genreForm.name && showValidationErrors"
				class="text-red-500 mt-1"
			>
				Genre name is required
			</small>
		</div>
	</form>

	<ng-template pTemplate="footer">
		<div class="flex gap-2">
			<p-button
				label="Cancel"
				icon="pi pi-times"
				severity="secondary"
				outlined="true"
				(onClick)="closeAddEditDialog()"
			></p-button>
			<p-button
				[label]="editingGenre ? 'Update' : 'Save'"
				icon="pi pi-check"
				severity="primary"
				(onClick)="saveGenre()"
				[disabled]="!genreForm.name"
			></p-button>
		</div>
	</ng-template>
</p-dialog>

<!-- Confirmation Dialog -->
<p-confirmDialog
	[style]="{ width: '450px' }"
	[baseZIndex]="10000"
	acceptButtonStyleClass="p-button-danger"
	rejectButtonStyleClass="p-button-secondary p-button-outlined"
></p-confirmDialog>
