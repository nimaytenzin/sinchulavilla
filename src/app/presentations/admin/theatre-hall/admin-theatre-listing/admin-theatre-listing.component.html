<!-- Theatre Listing Component -->
<div class="space-y-6">
	<!-- Search and Filter Bar -->
	<div
		class="flex justify-between items-center gap-4 flex-wrap"
		*ngIf="showFilters"
	>
		<div class="flex-1 max-w-md">
			<p-inputGroup>
				<p-inputGroupAddon>
					<i class="pi pi-search"></i>
				</p-inputGroupAddon>
				<input
					type="text"
					pInputText
					placeholder="Search theatres..."
					[(ngModel)]="searchTerm"
					(input)="onSearchChange()"
					class="w-full"
				/>
				<p-inputGroupAddon *ngIf="searchTerm">
					<i class="pi pi-times cursor-pointer" (click)="clearSearch()"></i>
				</p-inputGroupAddon>
			</p-inputGroup>
		</div>

		<div class="flex items-center gap-4">
			<!-- Status Filter -->
			<p-dropdown
				[options]="statusOptions"
				[(ngModel)]="selectedStatus"
				(onChange)="applyFilters()"
				placeholder="All Status"
				[showClear]="true"
				optionLabel="label"
				optionValue="value"
				styleClass="min-w-[120px]"
			></p-dropdown>

			<!-- Location Filter -->
			<p-dropdown
				[options]="locationOptions"
				[(ngModel)]="selectedLocation"
				(onChange)="applyFilters()"
				placeholder="All Locations"
				[showClear]="true"
				optionLabel="label"
				optionValue="value"
				styleClass="min-w-[120px]"
			></p-dropdown>

			<!-- Add Button -->
			<p-button
				*ngIf="showAddButton"
				label="Add Theater"
				icon="pi pi-plus"
				(onClick)="openAddTheatreDialog()"
				severity="primary"
			></p-button>
		</div>
	</div>

	<!-- Loading State -->
	<div class="flex justify-center items-center py-16" *ngIf="loading">
		<div class="text-center">
			<p-progressBar mode="indeterminate" styleClass="mb-4"></p-progressBar>
			<p class="text-slate-600">Loading...</p>
		</div>
	</div>
	<!-- Empty State -->
	<div
		class="text-center py-16 px-8"
		*ngIf="!loading && filteredTheatres.length === 0"
	>
		<div class="text-4xl text-slate-400 mb-6">
			<i class="fas fa-building"></i>
		</div>
		<h3 class="text-xl font-semibold text-slate-900 mb-2">No theatres found</h3>
		<p class="text-slate-600 mb-8 max-w-md mx-auto">
			{{
				searchTerm
					? "Try adjusting your search criteria"
					: "Get started by adding a new theater"
			}}
		</p>
		<p-button
			*ngIf="showAddButton"
			label="Add Theater"
			icon="pi pi-plus"
			(onClick)="openAddTheatreDialog()"
			severity="primary"
		></p-button>
	</div>

	<!-- Content Area -->
	<div *ngIf="!loading && filteredTheatres.length > 0">
		<!-- Table View -->
		<p-table
			[value]="filteredTheatres"
			[(selection)]="selectedItems"
			dataKey="id"
			[rowHover]="true"
			styleClass="p-datatable-sm"
		>
			<ng-template pTemplate="header">
				<tr>
					<th pSortableColumn="name">
						Name <p-sortIcon field="name"></p-sortIcon>
					</th>
					<th pSortableColumn="location">
						Location <p-sortIcon field="location"></p-sortIcon>
					</th>

					<th class="text-center">Halls</th>
					<th class="text-center">Total Seats</th>
					<th class="text-center">Actions</th>
				</tr>
			</ng-template>
			<ng-template pTemplate="body" let-theatre let-rowIndex="rowIndex">
				<tr [pSelectableRow]="theatre" [pSelectableRowIndex]="rowIndex">
					<td>
						<div>
							<div class="font-medium text-slate-900">{{ theatre.name }}</div>
						</div>
					</td>
					<td class="text-slate-700">
						<div class="text-sm text-slate-500">{{ theatre.address }}</div>

						{{ theatre.dzongkhag.name }}
					</td>

					<td class="text-center text-slate-700">
						{{ theatre.halls.length }}
					</td>
					<td class="text-center text-slate-700">
						{{ getTotalSeatsForTheatre(theatre.id) }}
					</td>

					<td class="text-center">
						<div class="flex gap-1 justify-center">
							<p-button
								icon="pi pi-pencil"
								severity="secondary"
								size="small"
								[text]="true"
								(onClick)="onTheatreEdit(theatre)"
								pTooltip="Edit Theatre"
							></p-button>

							<p-button
								icon="pi pi-home"
								severity="info"
								size="small"
								[text]="true"
								(onClick)="onManageHalls(theatre.id)"
								pTooltip="Manage Halls"
							></p-button>
							<p-button
								icon="pi pi-trash"
								severity="danger"
								size="small"
								[text]="true"
								(onClick)="onTheatreDelete(theatre)"
								pTooltip="Delete Theatre"
							></p-button>
						</div>
					</td>
				</tr>
			</ng-template>
		</p-table>
	</div>
</div>
